<!-- ================= HEADER ================= -->

<header class="topbar">
  <div class="topbar-left">
    <span class="hamburger" (click)="toggleSidebar()">â˜°</span>

    <div class="title-wrapper header-title">
      <img src="assets/icons/project-lens.png.jpg" alt="images" class="project-icon" />
      <h1 class="app-title">PROJECT <span>LENS</span></h1>
    </div>
  </div>
</header>

<!-- ================= SEARCH BELOW HEADER ================= -->

<div class="search-container-right">
  <div class="search-box">
    <input #searchInput type="text" placeholder="Search projects..." [(ngModel)]="searchText" />
    <span class="search-icon" (click)="focusSearch(searchInput)">
      ğŸ”
    </span>
  </div>
</div>

<!-- ================= SIDEBAR ================= -->
<!-- overlay -->
<div class="sidebar-overlay" *ngIf="isSidebarOpen" (click)="closeSidebar()">
</div>

<div class="sidebar" [class.open]="isSidebarOpen">
  <!-- Header / Branding -->
  <div class="sidebar-header vertical">
    <img src="assets/icons/project-lens.png.jpg" class="sidebar-main-icon" />

    <h3 class="sidebar-title">PROJECT LENS </h3>

    <p class="sidebar-subtitle">
      Manage your jobs & photos
    </p>

    <button class="close-btn" (click)="toggleSidebar()">âœ•</button>
  </div>

  <!-- Menu -->
  <ul class="sidebar-list">
    <li class="menu-item">
      <span class="menu-icon">ğŸ“‹</span>
      <span>Audit Logs</span>
    </li>

    <hr class="sidebar-divider" />

    <li class="menu-item logout">
      <span class="menu-icon">ğŸšª</span>
      <span>Logout</span>
    </li>
  </ul>
</div>

<!-- ================= PROJECT TABLE ================= -->

<div class="table-container">
  <table class="project-table">
    <thead>
      <tr>
        <th>SL No</th>
        <th>PO Number</th>
        <th>BOL Number</th>
        <th>File Name</th>
        <th>Created Date</th>
        <th>File Count</th>
        <th>View</th>
        <th>Download</th>
        <th>Share</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let project of filteredProjects; let i = index">
        <td>{{ i + 1 }}</td>
        <td>{{ project.poNumber || '-' }}</td>
        <td>{{ project.bolNumber || '-' }}</td>

        <td class="file-name">
          {{ project.fileName }}
        </td>

        <td class="created-date">
          <div class="date">
            {{ project.createdOn | date:'dd MMM yyyy' }}
          </div>
          <div class="time">
            {{ project.createdOn | date:'hh:mm a' }}
          </div>
        </td>

        <td>{{ project.fileCount }}</td>

        <!-- VIEW -->
        <td>
          <button class="icon-btn view" (click)="viewProject(project)">
            ğŸ‘
          </button>
        </td>

        <!-- DOWNLOAD -->
        <td>
          <button class="download-btn" (click)="downloadPDF(project)">
            Download
          </button>
        </td>

        <!-- SHARE -->
        <td>
          <button class="icon-btn share" (click)="openSharePopup(project)">
            ğŸ”—
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<p *ngIf="!loading && filteredProjects.length === 0" class="no-projects">
  No projects found
</p>

<!-- ================= SHARE POPUP ================= -->

<div class="popup-overlay" *ngIf="showSharePopup">
  <div class="share-popup">
    <h2>Share via Email</h2>

    <div class="form-group">
      <label>Name</label>
      <input type="text" [(ngModel)]="shareForm.name" />
    </div>

    <div class="form-group">
      <label>To</label>
      <input type="email" [(ngModel)]="shareForm.to" />
    </div>

    <div class="form-group">
      <label>CC (optional)</label>
      <input type="email" [(ngModel)]="shareForm.cc" />
    </div>

    <div class="popup-actions">
      <button class="btn-cancel" (click)="closeSharePopup()">Cancel</button>
      <button class="btn-send" (click)="sendEmail()">Send Email</button>
    </div>
  </div>
</div>